双线性插值是一种在二维网格上插值的方法，用于估算在已知网格点之间的未知值。尽管名字中包含“线性”二字，但双线性插值的函数实际上并不是简单的线性函数。其插值公式的形式可以表示为：

$$ F(x, y) = a_0 + a_1 x + a_2 y + a_3 xy $$

这种形式展示了双线性插值函数是关于 \(x\) 和 \(y\) 的二次多项式。

![image-20240703152655759](C:/Users/%E5%8D%8E%E7%9B%96%E5%B0%86%E5%80%BE/AppData/Roaming/Typora/typora-user-images/image-20240703152655759.png)

### 双线性插值的步骤

假设我们有一个二维网格，其四个已知点$ (x_0, y_0), (x_1, y_0), (x_0, y_1), (x_1, y_1)$，对应的函数值分别为 $(f(x_0, y_0), f(x_1, y_0), f(x_0, y_1), f(x_1, y_1))$。要估算点 (x, y) 处的值，双线性插值通过以下步骤进行：

1. **在 \(x\) 方向上插值**：
   - 在 \(y = y_0\) 处，进行线性插值得到点 \(E\)：
     $$ f(x, y_0) = \frac{(x_1 - x)}{(x_1 - x_0)} f(x_0, y_0) + \frac{(x - x_0)}{(x_1 - x_0)} f(x_1, y_0) $$
   - 在 \(y = y_1\) 处，进行线性插值得到点 \(F\)：
     $$ f(x, y_1) = \frac{(x_1 - x)}{(x_1 - x_0)} f(x_0, y_1) + \frac{(x - x_0)}{(x_1 - x_0)} f(x_1, y_1) $$

2. **在 \(y\) 方向上插值**：
   - 使用上面得到的 \(f(x, y_0)\) 和 \(f(x, y_1)\)，在 \(y\) 方向上进行插值，得到点 \((x, y)\) 的值：
     $$ f(x, y) = \frac{(y_1 - y)}{(y_1 - y_0)} f(x, y_0) + \frac{(y - y_0)}{(y_1 - y_0)} f(x, y_1) $$

### 数学联系

上述插值方法实际上可以简化为以下形式：

$$ f(x, y) = a_0 + a_1 x + a_2 y + a_3 xy $$

其中，系数 $a_0, a_1, a_2, a_3$可以通过已知网格点的值和插值公式来确定。具体地，这些系数与插值的步骤有关，如下所示：

$$ a_0 = f(x_0, y_0) $$
$$ a_1 = \frac{f(x_1, y_0) - f(x_0, y_0)}{x_1 - x_0} $$
$$ a_2 = \frac{f(x_0, y_1) - f(x_0, y_0)}{y_1 - y_0} $$
$$ a_3 = \frac{f(x_0, y_0) - f(x_1, y_0) - f(x_0, y_1) + f(x_1, y_1)}{(x_1 - x_0)(y_1 - y_0)} $$

这些系数的确定方法说明了双线性插值函数的非线性性质。

总之，双线性插值通过在两个方向上的两次线性插值来估算中间点的值，其结果可以表达为一个关于 \(x\) 和 \(y\) 的二次多项式形式，这解释了其与 $a_0 + a_1 x + a_2 y + a_3 xy$ 形式的联系。



所以我们可以直接写成这种f(x,y)的形式